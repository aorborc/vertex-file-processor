(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8721:function(e,s,t){Promise.resolve().then(t.bind(t,434))},434:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return a}});var n=t(7437),i=t(2265),l=t(9376);function a(){let[e,s]=(0,i.useState)("gs://gemini-lens-w9we5.firebasestorage.app/uploads/1756668214325-awfd10.pdf"),[t,a]=(0,i.useState)("You are an expert invoice parser. Extract structured JSON with per-field confidence (0-1). Return ONLY JSON. Fields: { supplier_name, supplier_address, supplier_tax_id, invoice_number, invoice_date, due_date, billing_details, shipping_address, bill_to, ship_to, currency, subtotal, tax, total, line_items: [{ description, indent_qty, dispatch_qty, received_qty, quantity, unit_price, amount, confidence }], fields_confidence: { field_name: score } }. Notes: (1) Parse handwritten values for received_qty when present (OK or a number). (2) Map item quantities: indent_qty = requested, dispatch_qty = shipped, received_qty = actually received. (3) Populate quantity as the received_qty if present, else the shipped/dispatch qty. (4) Provide numeric values where possible and dates in YYYY-MM-DD. (5) billing_details and shipping_address should be strings capturing the blocks labelled BILLING DETAILS and SHIPPING ADDRESS if present."),[r,c]=(0,i.useState)(!1),[d,o]=(0,i.useState)(null),[u,p]=(0,i.useState)(null),[h,m]=(0,i.useState)(null),[f,x]=(0,i.useState)(null),[_,g]=(0,i.useState)(null),j="https://us-central1-gemini-lens-w9we5.cloudfunctions.net/processFile",v="POST ".concat(j,'\nContent-Type: application/json\n\n{\n  "fileUrl": "https://.../file.pdf" | "gs://bucket/path.pdf",\n  "prompt": "<instruction>",\n  "model": "gemini-2.5-flash",\n  "location": "us-central1",\n  "useBatch": true\n}'),y=JSON.stringify({success:!0,gcsUri:"gs://<bucket>/uploads/<timestamp>-<id>.pdf",extracted:{supplier_name:"ACME Corp",supplier_name_confidence:.98,supplier_address:"123 Example St, City",supplier_address_confidence:.95,supplier_tax_id:"27ABCDE1234Z1Z5",supplier_tax_id_confidence:.9,invoice_number:"INV-12345",invoice_number_confidence:.99,invoice_date:"2025-08-31",invoice_date_confidence:.98,due_date:"2025-09-30",due_date_confidence:.8,bill_to:"Cloudstore Retail Pvt Ltd ...",bill_to_confidence:.95,ship_to:"Cloudstore Retail Pvt Ltd ...",ship_to_confidence:.95,currency:"INR",currency_confidence:.7,subtotal:3990,subtotal_confidence:.9,tax:0,tax_confidence:.5,total:3990,total_confidence:.99,line_items:[{description:"French Beans",description_confidence:.99,quantity:10,quantity_confidence:.99,unit_price:90,unit_price_confidence:.99,amount:900,amount_confidence:.99}],fields_confidence:{supplier_name:.98,invoice_number:.99,total:.99}},extractedRaw:{supplier_name:"ACME Corp",supplier_address:"123 Example St, City",supplier_tax_id:"27ABCDE1234Z1Z5",invoice_number:"INV-12345",invoice_date:"2025-08-31",due_date:"2025-09-30",bill_to:"Cloudstore Retail Pvt Ltd ...",ship_to:"Cloudstore Retail Pvt Ltd ...",currency:"INR",subtotal:3990,tax:0,total:3990,line_items:[{description:"French Beans",quantity:10,unit_price:90,amount:900,confidence:.99}],fields_confidence:{supplier_name:.98,invoice_number:.99,total:.99}},vertex:{modelVersion:"gemini-2.5-flash",candidates:[{}]}},null,2),b=(0,l.useRouter)();(0,i.useEffect)(()=>{if(r&&_){x("0.0");let e=setInterval(()=>{x(((Date.now()-_)/1e3).toFixed(1))},100);return()=>clearInterval(e)}x(null)},[r,_]);let N=async s=>{s.preventDefault(),c(!0),p(null),o(null),m(null);try{let s=Date.now();g(s);let n=await fetch(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileUrl:e,prompt:t})}),i=await n.json();if(!n.ok)throw Error((null==i?void 0:i.error)||"Request failed");o(i),m(Date.now()-s)}catch(e){p(e.message||"Unexpected error")}finally{c(!1)}};return(0,n.jsxs)("main",{className:"grid",style:{gap:16},children:[(0,n.jsxs)("div",{className:"card",style:{display:"flex",gap:12,alignItems:"center"},children:[(0,n.jsx)("span",{className:"badge",children:"Endpoints"}),(0,n.jsxs)("div",{className:"mono",title:"Process endpoint",children:["process: ",j]}),(0,n.jsxs)("div",{className:"mono",title:"Signed URL endpoint",children:["signed-url: ","https://us-central1-gemini-lens-w9we5.cloudfunctions.net/signedUrl"]})]}),(0,n.jsxs)("form",{onSubmit:N,className:"card grid",style:{gap:12},children:[(0,n.jsxs)("label",{className:"label",children:["PDF URL",(0,n.jsx)("input",{className:"input",type:"url",placeholder:"https://example.com/file.pdf",value:e,onChange:e=>s(e.target.value),required:!0}),(0,n.jsxs)("div",{className:"muted",style:{fontSize:12},children:["Original file URL (reference):",(0,n.jsx)("div",{className:"mono",style:{whiteSpace:"nowrap",overflowX:"auto"},children:"https://creatorapp.zohopublic.in/file/deloittettipl/trade-invoice-platform/Files/133740007807502149/upload_invoice/download/5WnO5ZXWDuSsTXDKDHKFN3wV2bj2zwCE47zZ97HVe7rCWHnjQQftsTpZqXeO7uBX0eu8qRrS6yANufr7b6PCOMmxk32t43nQeMNb?filepath=/1756645255475149_13.pdf"}),"See API Docs for differences between web file URLs and GCS gs:// URIs."]})]}),(0,n.jsxs)("label",{className:"label",children:["Prompt",(0,n.jsx)("textarea",{className:"textarea",value:t,onChange:e=>a(e.target.value),rows:4})]}),(0,n.jsxs)("button",{type:"submit",disabled:r,className:"btn",children:[(0,n.jsx)("svg",{className:"icon",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M2 21l21-9L2 3v7l15 2-15 2z"})}),r?"Processing…":"Send to Vertex"]})]}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("button",{type:"button",className:"btn secondary",disabled:!d,onClick:()=>{if(d){try{localStorage.setItem("lastResult",JSON.stringify(d))}catch(e){}b.push("/preview")}},children:[(0,n.jsx)("svg",{className:"icon",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M12 5c-7 0-10 7-10 7s3 7 10 7 10-7 10-7-3-7-10-7zm0 12a5 5 0 110-10 5 5 0 010 10z"})}),"Open Preview"]}),!d&&(0,n.jsx)("span",{className:"muted",children:"Run once to enable preview"})]}),u&&(0,n.jsxs)("p",{className:"card",style:{borderColor:"var(--danger)",color:"var(--danger)"},children:["Error: ",u]}),(0,n.jsxs)("details",{className:"card",style:{padding:12},open:!!d,children:[(0,n.jsxs)("summary",{style:{cursor:"pointer",fontWeight:600},children:["Response",r&&null!=f&&(0,n.jsxs)("span",{className:"badge",style:{marginLeft:8},children:[f," s"]}),!r&&null!=h&&(0,n.jsxs)("span",{className:"badge",style:{marginLeft:8},children:[(h/1e3).toFixed(1)," s"]}),!r&&(null==d?void 0:d.cachedProcess)&&(0,n.jsx)("span",{className:"badge",style:{marginLeft:8,background:"#d1fae5",color:"#065f46"},title:(()=>{let e=(null==d?void 0:d.cachedAt)?Date.parse(d.cachedAt):NaN;if(!Number.isNaN(e)){let s=Math.max(0,Math.floor((Date.now()-e)/6e4));return"Cached ".concat(s," min").concat(1===s?"":"s"," ago")}return"Cached"})(),children:"Cache: HIT"})]}),d&&(0,n.jsx)("pre",{className:"code mono",style:{marginTop:10},children:JSON.stringify(d,null,2)})]}),(0,n.jsxs)("details",{className:"card",style:{padding:12},children:[(0,n.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"UI Test Steps"}),(0,n.jsx)("div",{className:"grid",style:{gap:10,marginTop:10},children:(0,n.jsxs)("ol",{style:{margin:0,paddingLeft:18},children:[(0,n.jsx)("li",{children:"Enter a PDF URL (or gs:// URI) and adjust the prompt if needed."}),(0,n.jsx)("li",{children:"Click “Send to Vertex”. Observe the live timer in seconds on the Response header."}),(0,n.jsx)("li",{children:"When the response arrives, “Open Preview” becomes enabled."}),(0,n.jsx)("li",{children:"Click “Open Preview” to view the PDF on the left and extracted fields on the right."}),(0,n.jsx)("li",{children:"In Preview, edit numeric line items (Qty, Unit Price, Amount). Amount and summary (Subtotal/Total) recalc automatically."}),(0,n.jsx)("li",{children:"Trailing confidence (%) appears inside each input. The line items list scrolls independently."})]})})]}),(0,n.jsxs)("details",{className:"card",style:{padding:12},children:[(0,n.jsx)("summary",{style:{cursor:"pointer",fontWeight:600},children:"API Docs"}),(0,n.jsxs)("div",{className:"grid",style:{gap:10,marginTop:10},children:[(0,n.jsxs)("p",{className:"muted",children:["Send a PDF URL and prompt to Vertex AI. The server uploads to Google Cloud Storage and calls Gemini. In production, Hosting rewrites ",(0,n.jsx)("code",{children:"/api/process-file"})," to the Cloud Function."]}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["Effective API base: ",(0,n.jsx)("span",{className:"badge mono",children:j})]}),(0,n.jsx)("li",{children:"Accepts http/https or gs:// URLs"}),(0,n.jsxs)("li",{children:["Response includes ",(0,n.jsx)("code",{children:"gcsUri"}),", parsed ",(0,n.jsx)("code",{children:"extracted"}),", and full ",(0,n.jsx)("code",{children:"vertex"})]}),(0,n.jsxs)("li",{children:["Default model: ",(0,n.jsx)("code",{children:"gemini-2.5-flash"}),"; override with ",(0,n.jsx)("code",{children:"model"})," or change region via ",(0,n.jsx)("code",{children:"location"})]}),(0,n.jsxs)("li",{children:["Set ",(0,n.jsx)("code",{children:"useBatch"})," to ",(0,n.jsx)("code",{children:"false"})," to force single-request ",(0,n.jsx)("code",{children:"generateContent"})]}),(0,n.jsxs)("li",{children:["Repository: ",(0,n.jsx)("a",{href:"https://github.com/aorborc/vertex-file-processor",target:"_blank",rel:"noreferrer",children:"github.com/aorborc/vertex-file-processor"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{style:{margin:0},children:"Request"}),(0,n.jsx)("pre",{className:"code mono",children:v}),(0,n.jsxs)("p",{className:"muted",style:{marginTop:6,fontSize:12},children:[(0,n.jsx)("code",{children:"model"}),", ",(0,n.jsx)("code",{children:"location"}),", and ",(0,n.jsx)("code",{children:"useBatch"})," are optional; omit them to rely on server defaults."]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{style:{margin:0},children:"Response (sample)"}),(0,n.jsx)("pre",{className:"code mono",children:y})]})]})]})]})}},9376:function(e,s,t){"use strict";var n=t(5475);t.o(n,"useRouter")&&t.d(s,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8721)}),_N_E=e.O()}]);